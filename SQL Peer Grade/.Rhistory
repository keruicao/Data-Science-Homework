library(readxl)
library(tidyverse)
library(RSQLite)
library(DBI)
DB1 <- read_excel("Top MA Donors 2016-2020(2).xlsx")
Con_All = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "Direct Contributions & JFC Dist")
JFC = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "JFC Contributions (DO NOT SUM W")
apply(Con_All,MARGIN = 2,function(x){x %>% unique %>% length})
View(Con_All)
Con_All = Con_All %>% separate(col = contrib,into = Contrib, sep = "")
Con_All = Con_All %>% separate(col = contrib,into = contrib, sep = "")
Con_All = Con_All %>% separate(col = contrib,into = 'contrib', sep = "")
Con_All = Con_All %>% separate(col = contrib,into = 'contrib', sep = " ")
View(Con_All)
Con_All = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "Direct Contributions & JFC Dist")
C
a = Con_All$contrib
a = Con_All['contrib']
View(a)
a = separate(data = a, col = contrib, into = "a", sep = "")
a = separate(data = a, col = contrib, into = "a", sep = " ")
a = separate(data = a, col = contrib, into = "a", sep = " ")
a = Con_All['contrib']
a = separate(data = a, col = contrib, into = "a", sep = " ")
View(a)
View(Con_All)
a = Con_All['contrib']
a = separate(data = a, col = contrib, into = "a", sep = " B")
a = Con_All['contrib']
a = separate(data = a, col = contrib, into = c("FirstName","LastName"), sep = ", ")
a = Con_All['contrib']
b = separate(data = a, col = contrib, into = c("FirstName","LastName"), sep = ", ")
View(b)
a[3825,]
view(a)
gsub(a$contrib,pattern = " [a-z]",replacement = "")
b = gsub(a$contrib,pattern = " [a-z]",replacement = "")
b = gsub(a$contrib,pattern = " [A-Z]",replacement = "")
b
b = gsub(a$contrib,pattern = " [a-z]",replacement = "")
b
b = gsub(a$contrib,pattern = " \w",replacement = "")
b = gsub(a$contrib,pattern = '' [a-z]',replacement = "")
b = gsub(a$contrib,pattern = ' [a-z]',replacement = "")
b
b = gsub(a$contrib,pattern = ' \\w',replacement = "")
b
b = data.frame(gsub(a$contrib,pattern = ' \\w',replacement = ""))
b = data.frame(gsub(a$contrib,pattern = ' \\w*',replacement = ""))
View(b)
b = data.frame(grep(a$contrib,pattern = '\\w*,\\w*'))
b = data.frame(grep(a$contrib,pattern = '\\w*, \\w*'))
b = data.frame(grep(a$contrib,pattern = '\\w*))
b = data.frame(grep(a$contrib,pattern = '\\w*'))
b = data.frame(grep(a$contrib,pattern = '\\w'))
b = data.frame(grep(a$contrib,pattern = ' \\w'))
b = data.frame(grep(a$contrib,pattern = ' \w'))
b = data.frame(grep(a$contrib,pattern = ' \\w'))
View(b)
b = data.frame(gsub(a$contrib,pattern = ' \\w',replacement = ""))
b = data.frame(gsub(a$contrib,pattern = ' \\w*',replacement = ""))
b = data.frame(grep(a$contrib,pattern = ' \\w*'))
b = data.frame(grep(a$contrib,pattern = ' \\w*',value = T))
b = data.frame(grep(a$contrib,pattern = ' \\w*',value = T))
b = data.frame(grep(a$contrib,pattern = ' \\w',value = T))
b = data.frame(grep(a$contrib,pattern = ' [a-z]',value = T))
b = data.frame(grep(a$contrib,pattern = '\\s\\w*',value = T))
b = data.frame(grep(a$contrib,pattern = "\\s\\w*",value = T))
b = data.frame(grep(a$contrib,pattern = "\s",value = T))
b = data.frame(grep(a$contrib,pattern = "\\s*",value = T))
View(a)
b = data.frame(grep(a$contrib,pattern = "\\s\\w",value = T))
b = data.frame(grep(a$contrib,pattern = "\\s\\W",value = T))
b = data.frame(grep(a$contrib,pattern = "\\s\\w",value = T))
View(b)
b = data.frame(grep(a$contrib,pattern = " [A-Z]",value = T))
View(b)
b = data.frame(grep(a$contrib,pattern = " [A-Z]*",value = T))
View(b)
b = data.frame(gsub(a$contrib,pattern = ' \\w*',replacement = ""))
View(b)
b = data.frame(gsub(a$contrib,pattern = ' {2}\\w*',replacement = ""))
View(b)
b = data.frame(gsub(a$contrib,pattern = '\\s\\w*',replacement = ""))
View(b)
b = data.frame(gsub(a$contrib,pattern = '\\s{2}\\w*',replacement = ""))
View(b)
b = data.frame(gsub(a$contrib,pattern = '\\s[A-Z]',replacement = ""))
View(b)
b = data.frame(gsub(a$contrib,pattern = '\\s[A-Z]*',replacement = ""))
View(b)
b = data.frame(gsub(a$contrib,pattern = '\\s',replacement = ""))
View(b)
b = data.frame(gsub(a$contrib,pattern = '\\s?',replacement = ""))
View(b)
b = data.frame(gsub(a$contrib,pattern = '^\\s',replacement = ""))
View(b)
b = data.frame(gsub(a$contrib,pattern = ' ',replacement = ""))
View(b)
b = data.frame(gsub(a$contrib,pattern = '^\\s*ï¼Ÿ',replacement = ""))
b = data.frame(gsub(a$contrib,pattern = '^\\s*?',replacement = ""))
View(b)
b = data.frame(gsub(a$contrib,pattern = '\\s*?',replacement = ""))
View(b)
b = data.frame(gsub(a$contrib,pattern = '\\s',replacement = ""))
View(b)
b = data.frame(gsub(a$contrib,pattern = ', ',replacement = ","))
View(b)
b = data.frame(gsub(b$gsub.a.contrib..pattern.........replacement.......,pattern = '\\s\\w*',replacement = ""))
View(b)
Con_All = gsub(Con_All$contrib,pattern = ", ",replacement = "")
Con_All = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "Direct Contributions & JFC Dist")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = ", ",replacement = "")
Con_All = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "Direct Contributions & JFC Dist")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = ", ",replacement = ",")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = "\\s\\w*",replacement = "")
Con_All$contrib[863]
Con_All = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "Direct Contributions & JFC Dist")
Contribution = Con_all %>% select(cycle,contribid,fam,date,amount,recipid,type,fectransid) %>% distinct()
Contribution = Con_All %>% select(cycle,contribid,fam,date,amount,recipid,type,fectransid) %>% distinct()
Contributor = Con_All %>% select(contribid,fam,contrib,City,State,Zip,Fecoccemp,orgname,ultorg,lastname) %>% distinct()
View(Contributor)
View(Con_All)
Recipient = Con_All %>% select(recipid,recipient,party,recipcode,cmteid) %>% distinct()
DB1 <- read_excel("Top MA Donors 2016-2020(2).xlsx")
Con_All = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "Direct Contributions & JFC Dist")
JFC = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "JFC Contributions (DO NOT SUM W")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = ", ",replacement = ",")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = "\\s\\w*",replacement = "")
Contribution = Con_All %>% select(cycle,contribid,fam,date,amount,recipid,type,fectransid) %>% distinct()
Contributor = Con_All %>% select(contribid,fam,contrib,City,State,Zip,Fecoccemp,orgname,ultorg,lastname) %>% distinct()
Recipient = Con_All %>% select(recipid,recipient,party,recipcode,cmteid) %>% distinct()
View(Contributor)
unique(Contributor$contrib)
View(Contributor)
View(Contributor)
library(readxl)
library(tidyverse)
library(RSQLite)
library(DBI)
DB1 <- read_excel("Top MA Donors 2016-2020(2).xlsx")
Con_All = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "Direct Contributions & JFC Dist")
JFC = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "JFC Contributions (DO NOT SUM W")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = ", ",replacement = ",")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = "\\s\\w*",replacement = "")
Contribution = Con_All %>% select(cycle,contribid,fam,date,amount,recipid,type,fectransid) %>% distinct()
Contributor = Con_All %>% select(cycle,contribid,fam,contrib,City,State,Zip,Fecoccemp,orgname,ultorg,lastname) %>% distinct()
Recipient = Con_All %>% select(recipid,recipient,party,recipcode,cmteid) %>% distinct()
View(Contributor)
DB1 <- read_excel("Top MA Donors 2016-2020(2).xlsx")
Con_All = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "Direct Contributions & JFC Dist")
JFC = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "JFC Contributions (DO NOT SUM W")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = ", ",replacement = ",")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = "\\s\\w*",replacement = "")
Contribution = Con_All %>% select(cycle,contribid,fam,date,amount,recipid,type,fectransid,cmteid) %>% distinct()
Contributor = Con_All %>% select(cycle,contribid,fam,contrib,City,State,Zip,Fecoccemp,orgname,ultorg,lastname) %>% distinct()
Recipient = Con_All %>% select(recipid,recipient,party,recipcode) %>% distinct()
View(Recipient)
View(Contributor)
Contrib = dbConnect(SQLite(),"Contribution.sqlite")
dbWriteTable(Contrib,"Contribution",Contribution)
dbWriteTable(Contrib,"Contributor",Contributor)
dbWriteTable(Contrib,"Recipient",Recipient)
library(readxl)
library(tidyverse)
library(RSQLite)
library(DBI)
DB1 <- read_excel("Top MA Donors 2016-2020(2).xlsx")
Con_All = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "Direct Contributions & JFC Dist")
JFC = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "JFC Contributions (DO NOT SUM W")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = ", ",replacement = ",")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = "\\s\\w*",replacement = "")
Contribution = Con_All %>% select(cycle,contribid,fam,date,amount,recipid,type,fectransid,cmteid) %>% distinct()
Contributor = Con_All %>% select(contribid,fam,contrib,City,State,Zip,Fecoccemp,orgname,ultorg,lastname) %>% distinct()
Recipient = Con_All %>% select(recipid,recipient,party,recipcode) %>% distinct()
Contrib = dbConnect(SQLite(),"Contribution.sqlite")
dbWriteTable(Contrib,"Contribution",Contribution)
dbWriteTable(Contrib,"Contributor",Contributor)
dbWriteTable(Contrib,"Recipient",Recipient)
library(readxl)
library(tidyverse)
library(RSQLite)
library(DBI)
DB1 <- read_excel("Top MA Donors 2016-2020(2).xlsx")
Con_All = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "Direct Contributions & JFC Dist")
JFC = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "JFC Contributions (DO NOT SUM W")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = ", ",replacement = ",")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = "\\s\\w*",replacement = "")
Contribution = Con_All %>% select(cycle,contribid,fam,date,amount,recipid,type,fectransid,cmteid) %>% distinct()
Contributor = Con_All %>% select(contribid,fam,contrib,City,State,Zip,Fecoccemp,orgname,ultorg,lastname) %>% distinct()
Recipient = Con_All %>% select(recipid,recipient,party,recipcode) %>% distinct()
library(readxl)
library(tidyverse)
library(RSQLite)
library(DBI)
DB1 <- read_excel("Top MA Donors 2016-2020(2).xlsx")
Con_All = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "Direct Contributions & JFC Dist")
JFC = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "JFC Contributions (DO NOT SUM W")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = ", ",replacement = ",")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = "\\s\\w*",replacement = "")
Contribution = Con_All %>% select(cycle,contribid,fam,date,amount,recipid,type,fectransid,cmteid) %>% distinct()
Contributor = Con_All %>% select(contribid,fam,contrib,City,State,Zip,Fecoccemp,orgname,lastname) %>% distinct()
Recipient = Con_All %>% select(recipid,recipient,party,recipcode) %>% distinct()
Organization = Con_All %>% select(orgname,ultorg) %>% distinct()
View(Organization)
Organization = Con_All %>% select(orgname,ultorg) %>% distinct() %>% na.omit()
View(Organization)
library(readxl)
library(tidyverse)
library(RSQLite)
library(DBI)
DB1 <- read_excel("Top MA Donors 2016-2020(2).xlsx")
Con_All = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "Direct Contributions & JFC Dist")
JFC = read_excel("Top MA Donors 2016-2020(2).xlsx",sheet = "JFC Contributions (DO NOT SUM W")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = ", ",replacement = ",")
Con_All['contrib'] = gsub(Con_All$contrib,pattern = "\\s\\w*",replacement = "")
Contribution = Con_All %>% select(cycle,contribid,fam,date,amount,recipid,type,fectransid,cmteid) %>% distinct()
Contributor = Con_All %>% select(contribid,fam,contrib,City,State,Zip,Fecoccemp,orgname,lastname) %>% distinct()
Recipient = Con_All %>% select(recipid,recipient,party,recipcode) %>% distinct()
Organization = Con_All %>% select(orgname,ultorg) %>% distinct() %>% na.omit()
Contrib = dbConnect(SQLite(),"Kerui_Cao.sqlite")
dbWriteTable(Contrib,"Contribution",Contribution)
dbWriteTable(Contrib,"Contributor",Contributor)
dbWriteTable(Contrib,"Recipient",Recipient)
dbWriteTable(Contrib,"Organization",Organization)
Contrib = dbConnect(SQLite(),"Kerui_Cao.sqlite")
dbWriteTable(Contrib,"Organization",Organization)
